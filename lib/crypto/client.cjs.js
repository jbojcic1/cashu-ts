"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const o=require("@noble/curves/secp256k1"),l=require("@noble/hashes/utils"),u=require("./util.cjs.js"),c=require("./common.cjs.js"),m=require("./client/NUT11.cjs.js");function g(e){return d(l.randomBytes(32),u.bytesToNumber(o.secp256k1.utils.randomPrivateKey()),e)}function d(e,t,n){const i=c.hashToCurve(e);t||(t=u.bytesToNumber(o.secp256k1.utils.randomPrivateKey()));const r=o.secp256k1.ProjectivePoint.BASE.multiply(t),s=i.add(r);return n!==void 0?m.getSignedOutput({B_:s,r:t,secret:e},n):{B_:s,r:t,secret:e}}function a(e,t,n){return e.subtract(n.multiply(t))}function P(e,t,n,i){const r=i,s=a(e.C_,t,r);return{id:e.id,amount:e.amount,secret:n,C:s}}const y=e=>({amount:e.amount,C:e.C.toHex(!0),id:e.id,secret:new TextDecoder().decode(e.secret),witness:JSON.stringify(e.witness)}),b=e=>({amount:e.amount,C:c.pointFromHex(e.C),id:e.id,secret:new TextEncoder().encode(e.secret),witness:e.witness?JSON.parse(e.witness):void 0}),B=(e,t)=>({B_:e.B_.toHex(!0),amount:t});exports.blindMessage=d;exports.constructProofFromPromise=P;exports.createRandomBlindedMessage=g;exports.deserializeProof=b;exports.serializeBlindedMessage=B;exports.serializeProof=y;exports.unblindSignature=a;
//# sourceMappingURL=client.cjs.js.map
